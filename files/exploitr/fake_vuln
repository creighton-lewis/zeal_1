<?xml version="1.0" encoding="UTF-8"?>
<!--
  Fake Nmap XML – includes a vulners script result with CVE‑2001‑1002
  You can use this file to test the parser's vulnerability‑extraction logic.
-->
<nmaprun scanner="nmap"
         args="nmap -sS -p 80 -sV --script vulners 127.0.0.1"
         start="1700000000"
         startstr="Thu Apr 27 12:00:00 2024"
         version="7.90"
         xmloutputversion="1.04">

  <scaninfo type="syn" protocol="tcp" numservices="1" services="80"/>

  <host>
    <status state="up" reason="hostup" reason_ttl="0"/>
    <address addr="127.0.0.1" addrtype="ipv4"/>
    <hostnames>
      <hostname name="localhost" type="user" method="default"/>
    </hostnames>

    <ports>
      <port protocol="tcp" portid="80">
        <state state="open" reason="syn-ack"/>
        <service name="http" product="Apache httpd" version="2.4.48" extrainfo="Apache/2.4.48 (Ubuntu)"/>
      </port>
    </ports>

    <!-- 1.  JSON‑style vulners output (Nmap ≥7.60) -->
    <script id="vulners"
            output='{"vulners":[{"cve":"CVE-2001-1002","description":"Test vulnerability for unit‑testing"}]}'/>

    <!-- 2.  Fallback plain‑text vulners script result -->
    <script id="vulners" output="
CVE-2001-1002: Test vulnerability for unit‑testing
CVE-2023-9999: Dummy other CVE
"/>
  </host>
</nmaprun>
